var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(a,l,s)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s,u=(e,u)=>{for(var t in u||(u={}))l.call(u,t)&&r(e,t,u[t]);if(a)for(var t of a(u))s.call(u,t)&&r(e,t,u[t]);return e};import{u as t,T as n,H as o,P as i}from"./rounded-button.afd62da9.js";import{p as d,R as v,C as p}from"./index.4a9faac5.js";import{d as c,k as m,r as y,l as f,h as b,a6 as w,a7 as g,a8 as h,a9 as x,aa as k,ab as I,n as N,B as j,F as C,ac as O,ad as P}from"./vendor.031f8059.js";var q=c((()=>{const{checkedRowKeys:e,data:a,fetchDataFn:l,pager:s,sortProps:r}=t(((e,a)=>async(a,l)=>{e.value=await v.api.users("").get()})),c=m(),q=y(!1),z=y({username:"",realName:"",address:"",email:"",password:"",gender:"男"});f((()=>{l()}));const A=async()=>{const e=z.value.id;if(e){await v.api.users.put({data:z.value});const l=a.value.findIndex((a=>a.id==e));a.value[l]=u(u({},a.value[l]),P(z.value))}else{const e=await v.api.users.post({data:u({},z.value)});a.value.unshift(e)}c.success("操作成功"),z.value={username:"",realName:"",address:"",email:"",password:"",gender:"男"},q.value=!1};return()=>b(p,{actionsElement:b(C,null,b(o,{icon:b(i,null),variant:"primary",onClick:()=>{z.value={username:"",realName:"",address:"",email:"",password:"",gender:"男"},q.value=!0}}))},b(n,{data:a,columns:[{title:"用户名",key:"username"},{title:"名字",key:"realName"},{title:"地址",key:"address"},{title:"创建时间",key:"createdAt",render:({createdAt:e})=>d(e,"yyyy年M月d日 HH:mm:ss")},{title:"操作",key:"id",fixed:"right",render:e=>b(C,null,b(N,{wrap:!1},b(j,{text:!0,size:"tiny",type:"info",onClick:a=>{q.value=!0,z.value=u({},e)}},"编辑"),b(O,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await v.api.users(e.username).delete(),c.success("删除成功"),await l()}},{trigger:()=>b(j,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>b("span",{style:{maxWidth:"12rem"}},"确定要删除用户 ",e.username," ?")})))}],noPagination:!0}),b(w,{show:q.value,onUpdateShow:e=>{q.value=e}},b(g,{style:"width: 500px;max-width: 90vw",headerStyle:{textAlign:"center"},title:z.value.id?"编辑: "+z.value.username:"新增"},b(h,null,b(x,{label:"用户名",required:!0},b(k,{disabled:void 0!==z.value.id,autofocus:!0,value:z.value.username,onInput:e=>{z.value.username=e}})),b(x,{label:"真实姓名",required:!0},b(k,{autofocus:!0,value:z.value.realName,onInput:e=>{z.value.realName=e}})),!z.value.id&&b(x,{label:"密码",required:!0},b(k,{autofocus:!0,value:z.value.password,type:"password",onInput:e=>{z.value.password=e}})),b(x,{label:"邮箱",required:!0},b(k,{autofocus:!0,value:z.value.email,onInput:e=>{z.value.email=e}})),b(x,{label:"喜好",required:!0},b(k,{autofocus:!0,value:z.value.favourite,onInput:e=>{z.value.favourite=e}})),b(x,{label:"地址"},b(k,{autofocus:!0,value:z.value.address,onInput:e=>{z.value.address=e}})),b(x,{label:"性别"},b(I,{placeholder:"选择性别",options:[{label:"男",value:"男"},{label:"女",value:"女"}],value:z.value.gender,onUpdateValue:e=>{z.value.gender=e}})),b(x,{label:"类型"},b(I,{placeholder:"选择类型",options:[{label:"管理员",value:"admin"},{label:"用户",value:"user"}],value:z.value.role,onUpdateValue:e=>{z.value.role=e}}))),b("div",{class:"text-right"},b(N,{size:12,align:"center",inline:!0},b(j,{type:"success",onClick:A,round:!0},"确定"),b(j,{onClick:()=>{q.value=!1,z.value={username:"",realName:"",address:"",email:"",password:"",gender:"男"}},round:!0},"取消"))))))}));export default q;
