var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,n=(e,n)=>{for(var u in n||(n={}))t.call(n,u)&&i(e,u,n[u]);if(a)for(var u of a(n))l.call(n,u)&&i(e,u,n[u]);return e};import{u,T as r,H as s,P as o}from"./rounded-button.afd62da9.js";import{R as d,C as c}from"./index.4a9faac5.js";import{d as p,k as v,r as m,l as y,h as b,a6 as g,a7 as f,a8 as w,a9 as h,aa as P,ab as x,ak as I,n as k,B as j,F as C,ac as q,ad as z}from"./vendor.031f8059.js";var O=p((()=>{const{checkedRowKeys:e,data:a,fetchDataFn:t,pager:l,sortProps:i}=u(((e,a)=>async(t=0,l=10)=>{const i=await d.api.products.get({params:{page:t,size:l}});e.value=i.content,a.value={currentPage:i.pageable.pageNumber,size:i.size,hasNextPage:!i.last,hasPrevPage:!i.first,total:i.totalElements,totalPage:i.totalPages}})),p=v(),O=m(!1),E=m({name:"",id:void 0,bigPic:"",brand:"",code:"",intro:"",num:0,pic:"",price:0,status:0,typeId:null}),N=m([]);y((()=>{t(),(async()=>{const e=await d.api.types.all.get();N.value=e})()}));const S=async()=>{const e=E.value.id;if(e){await d.api.products(e).put({data:E.value});const t=a.value.findIndex((a=>a.id==e));a.value[t]=n(n({},a.value[t]),z(E.value))}else{const e=await d.api.products.post({data:n({},E.value)});a.value.unshift(e)}p.success("操作成功"),E.value={name:"",id:void 0,bigPic:"",brand:"",code:"",intro:"",num:0,pic:"",price:0,status:0,typeId:null},O.value=!1};return()=>b(c,{actionsElement:b(C,null,b(s,{icon:b(o,null),variant:"primary",onClick:()=>{E.value={name:"",id:void 0,bigPic:"",brand:"",code:"",intro:"",num:0,pic:"",price:0,status:0,typeId:null},O.value=!0}}))},b(r,{pager:l,data:a,columns:[{title:"名称",key:"name"},{title:"数量",key:"num"},{title:"价格",key:"price"},{title:"类别",key:"typeId",render(e){var a,t,l,i;return console.log(null==(t=null==(a=null==N?void 0:N.value)?void 0:a.find((a=>a.id==e.typeId)))?void 0:t.name),b("span",null,null==(i=null==(l=null==N?void 0:N.value)?void 0:l.find((a=>a.id==e.typeId)))?void 0:i.name)}},{title:"操作",key:"id",fixed:"right",render:e=>b(C,null,b(k,{wrap:!1},b(j,{text:!0,size:"tiny",type:"info",onClick:a=>{O.value=!0,E.value=n({},e)}},"编辑"),b(q,{positiveText:"取消",negativeText:"删除",onNegativeClick:async()=>{await d.api.products(e.id).delete(),p.success("删除成功"),await t()}},{trigger:()=>b(j,{text:!0,type:"error",size:"tiny"},"移除"),default:()=>b("span",{style:{maxWidth:"12rem"}},"确定要删除 ",e.username," ?")})))}]}),b(g,{show:O.value,onUpdateShow:e=>{O.value=e}},b(f,{style:"width: 500px;max-width: 90vw",headerStyle:{textAlign:"center"},title:E.value.id?"编辑":"新增"},b(w,null,b(h,{label:"名称",required:!0},b(P,{autofocus:!0,value:E.value.name,onInput:e=>{E.value.name=e}})),b(h,{label:"类别",required:!0},b(x,{value:E.value.typeId,onChange:e=>{E.value.typeId=e},options:N.value.map((e=>({label:e.name,value:e.id})))})),b(h,{label:"图片",required:!0},b(P,{value:E.value.pic,onInput:e=>{E.value.pic=e}})),b(h,{label:"价格",required:!0},b(I,{value:E.value.price,onUpdateValue:e=>{E.value.price=e}})),b(h,{label:"编码",required:!0},b(P,{value:E.value.code,onInput:e=>{E.value.code=e}})),b(h,{label:"数量",required:!0},b(I,{value:E.value.num,onUpdateValue:e=>{E.value.num=e}}))),b("div",{class:"text-right"},b(k,{size:12,align:"center",inline:!0},b(j,{type:"success",onClick:S,round:!0},"确定"),b(j,{onClick:()=>{O.value=!1,E.value={name:"",id:void 0,bigPic:"",brand:"",code:"",intro:"",num:0,pic:"",price:0,status:0,typeId:null}},round:!0},"取消"))))))}));export default O;
